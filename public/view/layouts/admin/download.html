<!DOCTYPE html>
<html>
  <head>
    <title>Create XLSX File</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  </head>
  <body>
    <h1>Generate XLSX File</h1>
    <button onclick="downloadXLSX()">Download XLSX</button>

    <script>
      function downloadXLSX() {
        // Sample data (replace this with your data)
        const data = [
          ["Name", "Age", "Email"],
          ["John Doe", 30, "john.doe@example.com"],
          ["Jane Smith", 25, "jane.smith@example.com"],
          ["Bob Johnson", 35, "bob.johnson@example.com"],
        ];

        // Create a new workbook and worksheet
        const workbook = XLSX.utils.book_new();
        const worksheet = XLSX.utils.aoa_to_sheet(data);

        // Add the worksheet to the workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, "Sheet1");

        // Convert the workbook to a binary XLSX file
        const wbout = XLSX.write(workbook, {
          bookType: "xlsx",
          type: "binary",
        });

        // Convert the binary XLSX to a Blob object
        const blob = new Blob([s2ab(wbout)], {
          type: "application/octet-stream",
        });

        // Create a download link element
        const downloadLink = document.createElement("a");
        downloadLink.href = URL.createObjectURL(blob);
        downloadLink.download = "sample.xlsx"; // File name for the downloaded XLSX

        // Append the link to the document and trigger the click event
        document.body.appendChild(downloadLink);
        downloadLink.click();

        // Clean up the link after the download
        document.body.removeChild(downloadLink);
      }

      // Utility function to convert a string to an ArrayBuffer
      function s2ab(s) {
        const buf = new ArrayBuffer(s.length);
        const view = new Uint8Array(buf);
        for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff;
        return buf;
      }
    </script>
  </body>
</html>
